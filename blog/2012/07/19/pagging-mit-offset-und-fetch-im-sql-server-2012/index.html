<!DOCTYPE html> <html lang="en"> <head> <meta charset="utf-8"> <title>Robert Meyer Consulting</title> <meta name="viewport" content="width=device-width, initial-scale=1"> <link rel="shortcut icon" type="image/x-icon" href="./Logo.ico"> <link href="https://fonts.googleapis.com/css?family=Poppins:400,400i,500,500i,600,600i,700,700i,800,800i,900,900i&display=swap" rel="stylesheet"> <link href="https://fonts.googleapis.com/css?family=Open+Sans:300,400,600,700&display=swap" rel="stylesheet"> <link href="/assets/fonts/fontawesome-webfont.woff2?v=4.7.0" rel="preload" as="font" type="font/woff2" onload="this.onload=null;this.rel='stylesheet'" crossorigin> <link type="text/css" media="all" href="/assets/css/bootstrap.min.css" rel="stylesheet"> <link type="text/css" media="all" href="/assets/css/jquery.animatedheadline.css" rel="stylesheet"> <link type="text/css" media="all" href="/assets/css/font-awesome.min.css" rel="stylesheet"> <link type="text/css" media="all" href="/assets/css/style.css" rel="stylesheet"> <link type="text/css" media="all" href="/assets/css/skins/goldrenrod.css" rel="stylesheet"> <link type="text/css" media="all" href="/assets/css/rougify-github.css" rel="stylesheet"> <link href="https://www.google-analytics.com" rel=preconnect> <script src="/assets/js/modernizr.js"></script> <title>Paging mit OFFSET und FETCH im SQL Server 2012 | Robert Meyer Consulting</title> <meta name="generator" content="Jekyll v4.1.1"/> <meta property="og:title" content="Paging mit OFFSET und FETCH im SQL Server 2012"/> <meta name="author" content="Robert Meyer"/> <meta property="og:locale" content="en"/> <meta name="description" content="Lange hat es gedauert, doch nun beherrscht der SQL Server mit Version 2012 endlich das Paging. Unter Paging versteht man die Festlegung davon wie viele Datensätze pro Seite ausgeben werden sollen. Dies wird besonders bei diversen Webapplikationen benötigt um die Anzahl der geladenen Daten zu verringern."/> <meta property="og:description" content="Lange hat es gedauert, doch nun beherrscht der SQL Server mit Version 2012 endlich das Paging. Unter Paging versteht man die Festlegung davon wie viele Datensätze pro Seite ausgeben werden sollen. Dies wird besonders bei diversen Webapplikationen benötigt um die Anzahl der geladenen Daten zu verringern."/> <link rel="canonical" href="https://meyer-consulting.net/blog/2012/07/19/pagging-mit-offset-und-fetch-im-sql-server-2012/"/> <meta property="og:url" content="https://meyer-consulting.net/blog/2012/07/19/pagging-mit-offset-und-fetch-im-sql-server-2012/"/> <meta property="og:site_name" content="Robert Meyer Consulting"/> <meta property="og:type" content="article"/> <meta property="article:published_time" content="2012-07-19T00:25:45-05:00"/> <meta name="twitter:card" content="summary"/> <meta property="twitter:title" content="Paging mit OFFSET und FETCH im SQL Server 2012"/> <meta name="twitter:site" content="@roeb"/> <meta name="twitter:creator" content="@Robert Meyer"/> <script type="application/ld+json">
{"url":"https://meyer-consulting.net/blog/2012/07/19/pagging-mit-offset-und-fetch-im-sql-server-2012/","@type":"BlogPosting","publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"https://meyer-consulting.net/assets/Logo.png"},"name":"Robert Meyer"},"headline":"Paging mit OFFSET und FETCH im SQL Server 2012","dateModified":"2012-07-19T00:25:45-05:00","datePublished":"2012-07-19T00:25:45-05:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://meyer-consulting.net/blog/2012/07/19/pagging-mit-offset-und-fetch-im-sql-server-2012/"},"author":{"@type":"Person","name":"Robert Meyer"},"description":"Lange hat es gedauert, doch nun beherrscht der SQL Server mit Version 2012 endlich das Paging. Unter Paging versteht man die Festlegung davon wie viele Datensätze pro Seite ausgeben werden sollen. Dies wird besonders bei diversen Webapplikationen benötigt um die Anzahl der geladenen Daten zu verringern.","@context":"https://schema.org"}</script> <script>!function(e,a,t,n,o,c,s){e.GoogleAnalyticsObject=o,e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date,c=a.createElement(t),s=a.getElementsByTagName(t)[0],c.async=1,c.src=n,s.parentNode.insertBefore(c,s)}(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-160199639-1","auto"),ga("send","pageview",{page:location.pathname+location.search+location.hash}),ga("set","anonymizeIp",!0);</script> </head> <body class="dark fullscreendark"> <div class="page"> <div class="stretchy-nav-background"></div> <header id="header"> <div class="cd-stretchy-nav"> <a class="cd-nav-trigger" href="#0" aria-label="Navigation"> <span aria-hidden="true"></span> </a> <ul class="stretchy-nav"> <li> <a href="/"> <span> Home </span> </a> </li> <li> <a href="/about"> <span> About me </span> </a> </li> <li> <a href="/services"> <span> My services </span> </a> </li> <li> <a href="/talks"> <span> Talks </span> </a> </li> <li> <a href="/blog"> <span> Blog </span> </a> </li> <li> <a href="/contact"> <span> Contact </span> </a> </li> </ul> <span aria-hidden="true" class="stretchy-nav-bg"></span> </div> </header> <main id="main"> <span class="back-mobile" id="back-mobile"><i class="fa fa-arrow-left"></i></span> <div class="dark blog wrapper"> <div class="container-fluid page-title post-title"> <div class="content-banner"> <h2 class="text-center"> <span>Paging mit OFFSET und FETCH im SQL Server 2012</span> </h2> <div class="meta"> <span><i class="fa fa-user"></i> <a href="#">Robert Meyer</a></span> <span class="date"><i class="fa fa-calendar"></i>19 Jul 2012</span> <span><i class="fa fa-tags"></i> <span>FETCH</span> <span>OFFSET</span> <span>ORDER BY</span> <span>ROW_NUMBER</span> <span>SQL Server 2012</span> <span>TOP</span> </span> <span class="permalink"><i class="fa fa-link"></i> <a href="/blog/2012/07/19/pagging-mit-offset-und-fetch-im-sql-server-2012/">permalink</a></span> </div> </div> </div> <div class="container"> <div class="row"> <div class="content"> <article> <div class="blog-excerpt post"> <p>Lange hat es gedauert, doch nun beherrscht der SQL Server mit Version 2012 endlich das Paging. Unter Paging versteht man die Festlegung davon wie viele Datensätze pro Seite ausgeben werden sollen. Dies wird besonders bei diversen Webapplikationen benötigt um die Anzahl der geladenen Daten zu verringern.</p> <p>Würde die Suche auf einer Website ein Trefferergebnis von 400 Datensätzen betragen, möchte der Nutzer sicherlich nicht alle 400 Datensätze mit einmal auf der Website sehen, sondern z.B. immer nur 20 Stück. Diese 20 Datensätze werden jetzt auf 20 Seiten aufgelistet. Damit der Traffic möglichst gering bleibt, werden auch immer nur die Datensätze der aktuellen Seite geladen. Das nennt man Paging.</p> <h5 id="möglichkeiten-mit-dem-sql-server-2012">Möglichkeiten mit dem SQL Server 2012</h5> <p>Mit dem SQL Server 2012 kommen unter anderen zwei neue Befehle welche in der ORDER BY Klausel genutzt werden können:</p> <ul> <li> <p><strong>OFFSET</strong><br/> Legt fest wie viele Datensätze übersprungen werden, bevor Datensätze zurückgegeben werden.</p> </li> <li> <p><strong>FETCH</strong><br/> Gibt an wie viele Datensätze nach der OFFSET Klausel angezeigt werden sollen</p> </li> </ul> <h5 id="beispiel">Beispiel</h5> <p>In dem Beispiel werden Kundendaten selektiert, welche mit dem Nachnamen Meyer beginnen. Allerdings werden die ersten 40 Zeilen übersprungen und von da an 20 Zeilen selektiert.</p> <p><img src="/assets/img/blog/2012/offset_1.png" alt=""/></p> <h5 id="varianten-von-offset-und-fetch">Varianten von OFFSET und FETCH</h5> <p>Anstelle von NEXT kann man auch FIRST genutzt werden, es handelt sich hierbei nur um ein Synonym. Das gleich gilt für das Wort ROWS, hier kann auch ROW genutzt werden. Anstelle der direkten Anzahl der Datensätze bei OFFSET oder FETCH kann hier auch eine Variable zum Einsatz kommen. Dies könnte zum Beispiel so aussehen und wäre im zusammenhangen mit dynamisches Stored Procedures recht interessant.</p> <p><img src="/assets/img/blog/2012/offset_2.png" alt=""/></p> <h5 id="expressions-in-offset-und-fetch">Expressions in OFFSET und FETCH</h5> <p>Es ist ebenfalls möglich Expressions im Zusammenhang von OFFSET und FETCH zu nutzen. Hier ein Beispiel:</p> <p><img src="/assets/img/blog/2012/offset_3.png" alt=""/></p> <p>Zur Verfügung stehen die Erweiterungen OFFSET und FETCH bereits ab dem SQL Server 2012 Express.</p> </div> </article> </div> </div> </div> </div> </main> <footer id="footer"> <style>
    #cookie-notice {
        width: 100vw;
        background: #ccc;
        padding: 0.5rem 1rem;
        display: none;
        text-align: center;
    }

    #cookie-notice span {
        color: #000;
    }

    #cookie-notice a {
        display: inline-block;
        cursor: pointer;
        margin-left: 0.5rem;
        color: #333;
    }

    #cookie-notice a span {
        color: #333;
    }

    #cookie-notice a:hover span {
        color: #fff;
    }

    @media (max-width: 767px) {
        #cookie-notice span {
            display: block;
            padding-top: 3px;
            margin-bottom: 1rem;
        }

        #cookie-notice a {
            position: relative;
            bottom: 4px;
        }
    }
</style> <div id="cookie-notice"> <span> We would like to use third party cookies and scripts to improve the functionality of this website. </span> <a id="cookie-notice-accept" class="btn"> <span> Approve </span> </a> <a href="/privacy" class="btn" aria-label="Privacy information"> <span> Privacy Info </span> </a> </div> <script>function createCookie(e,o,t){var i="";if(t){var n=new Date;n.setTime(n.getTime()+24*t*60*60*1e3),i="; expires="+n.toUTCString()}document.cookie=e+"="+o+i+"; path=/"}function readCookie(e){for(var o=e+"=",t=document.cookie.split(";"),i=0;i<t.length;i++){for(var n=t[i];" "==n.charAt(0);)n=n.substring(1,n.length);if(0==n.indexOf(o))return n.substring(o.length,n.length)}return null}function eraseCookie(e){createCookie(e,"",-1)}"true"==readCookie("cookie-notice-dismissed")||(document.getElementById("cookie-notice").style.display="block"),document.getElementById("cookie-notice-accept").addEventListener("click",function(){createCookie("cookie-notice-dismissed","true",31),document.getElementById("cookie-notice").style.display="none",location.reload()});</script> <div class="social-media"> <div class="language"> <a href="https://meyer-consulting.net/de/" aria-label="German"> <img src="/assets/icons/german.png" alt="German"/> </a> </div> <div class="social-media icons"> <a href="https://twitter.com/roeb" target="_blank" rel=”noopener”> <div class="social-icon twitter"></div> </a> <a href="https://github.com/roeb" target="_blank" rel=”noopener”> <div class="social-icon github"></div> </a> <a href="https://www.linkedin.com/in/robert-meyer-332b2b28/" target="_blank" rel=”noopener”> <div class="social-icon linkedin"></div> </a> <a href="https://www.xing.com/profile/Robert_Meyer10" target="_blank" rel=”noopener”> <div class="social-icon xing"></div> </a> <a href="https://keybase.io/roeb/" target="_blank" rel=”noopener”> <div class="social-icon keybase"></div> </a> <a href="https://www.malt.de/profile/robertmeyer" target="_blank" rel=”noopener”> <div class="social-icon malt"></div> </a> <a href="https://meyer-consulting.net/feed.xml" target="_blank" rel=”noopener”> <div class="social-icon rss"></div> </a> </div> <div class="legal-notice"> <a href="/impressum"> Legal notice </a> <a href="/privacy" aria-label="Privacy information"> Privacy notice </a> </div> </div> </footer> </div> <script src="/assets/js/jquery-2.2.4.min.js"></script> <script src="/assets/js/jquery.animatedheadline.js"></script> <script src="/assets/js/bootstrap.min.js"></script> <script src="/assets/js/transition.js"></script> <script src="/assets/js/custom.js"></script> </body> </html>